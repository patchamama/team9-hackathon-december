<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="assets/styles.css" />
    <title>Card Play</title>
  </head>
  <body>
    <!-- Main Content Section -->
    <div class="container main-container">
      <!-- Image Options -->
      <div class="image-container">
        <img
          src="assets/images/options/christmas-card-1843552_1280.jpg"
          alt="Selected Image"
          class="img-fluid mt-2"
          id="imageCard"
        />
        <div class="text-overlay" id="text-inside-card">
          <p id="text-inside-card" class="text-overlay-text"></p>
        </div>
      </div>
      <div class="sound-container">
        <audio controls id="soundCard">
          <source src="" type="audio/mp3" />
        </audio>
        <br />
      </div>

      <hr />
      <div id="params-container"></div>
    </div>

    <script>
      // Function to retrieve URL parameters
      // play.js?imageopt=christmas-tree-2928142_1280.jpg&sname=Robert&rname=Petra&sound=enchanted-chimes-177906.mp3&ctext=Merry%20Christmas%0A1%0A2%0A3&video=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DaAkMkVFwAoo%26ab_channel%3DMariahCareyVEVO&tpos=top&imagesrc=internal&soundsrc=internal
      function getParameters() {
        // Get the current URL
        var url = window.location.href

        // Find the question mark (?) in the URL
        var index = url.indexOf('?')
        if (index !== -1) {
          // Get the query string after the question mark
          var queryString = url.slice(index + 1)

          // Split the query string into key-value pairs
          var params = queryString.split('&')

          // Object to store the parameters
          var paramsObj = {}

          // Iterate over the key-value pairs and store them in the object
          params.forEach(function (param) {
            var pair = param.split('=')
            var key = decodeURIComponent(pair[0])
            var value = decodeURIComponent(pair[1] || '')
            paramsObj[key] = value
          })

          // Update the image source
          var image = document.getElementById('imageCard')
          image.src = 'assets/images/options/' + paramsObj.imageopt

          // Update the text inside the card
          var text = document.getElementById('text-inside-card')
          text.innerHTML = paramsObj.ctext.replace(/\n/g, '<br />')

          // Play the sound
          //var sound = new Audio('assets/sounds/' + paramsObj.sound)
          var soundCard = document.getElementById('soundCard')
          soundCard.src = 'assets/sounds/' + paramsObj.sound
          soundCard.play()

          // Show the parameters in the container
          showParameters(paramsObj)
        }
      }

      // Function to display the parameters in the container
      function showParameters(params) {
        var container = document.getElementById('params-container')

        // Create an unordered list
        var ul = document.createElement('ul')

        // Iterate over the parameters and create list item elements
        for (var key in params) {
          if (params.hasOwnProperty(key)) {
            var li = document.createElement('li')
            li.textContent = key + ': ' + params[key]
            ul.appendChild(li)
          }
        }

        // Append the list to the container
        container.appendChild(ul)
      }

      // Call the function to retrieve and display parameters when the page loads
      getParameters()
    </script>

    <!-- Bootstrap JS (optional) -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="assets/scripts/script.js"></script>
  </body>
</html>
